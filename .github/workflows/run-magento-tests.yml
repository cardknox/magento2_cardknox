name: m2-actions-test
on: 
  push:
    branches-ignore: 
      - 'master'
      - 'rc/*/*/*'

jobs:
  magento2-build:
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: 'Magento Install'
      uses: MAD-I-T/magento-actions@v3.8
      with:
        process: 'install-magento'
        magento_version: 2.4.6
        no_push: 1
    - name: 'Magento Build'
      uses: MAD-I-T/magento-actions@v3.8
      with:
        php: '7.4'
        process: 'build'
        elasticsearch: 1
    - name: 'Magento Unit Tests'
      uses: MAD-I-T/magento-actions@v3.8
      with:
        process: 'unit-test'
        elasticsearch: 1
        unit_test_config: 'dev\tests\unit\phpunit.xml.dist'
        unit_test_subset_path: 'app\code\CardknoxDevelopment\Cardknox\Test'